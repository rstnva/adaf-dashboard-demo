(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7100],{8327:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(11097).A)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},9262:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(11097).A)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},12686:(e,t,s)=>{"use strict";s.d(t,{p:()=>n});var a=s(51833);s(59693);var r=s(81429);function n(e){let{className:t,type:s,...n}=e;return(0,a.jsx)("input",{type:s,"data-slot":"input",className:(0,r.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",t),...n})}},20405:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>S});var a=s(51833),r=s(59693),n=s(83738),l=s(11622),i=s(12686),d=s(85994);function o(e){let{onFiltersChange:t,onToast:s}=e,o=(0,n.useRouter)(),c=(0,n.useSearchParams)(),[u,m]=(0,r.useState)(c.get("status")||"proposed"),[x,h]=(0,r.useState)(c.get("type")||"any"),[p,f]=(0,r.useState)(c.get("q")||""),[g,j]=(0,r.useState)(c.get("order")||"score"),[b,v]=(0,r.useState)(c.get("dir")||"desc"),[N,y]=(0,r.useState)(Number(c.get("limit")||"50")),[w,k]=(0,r.useState)(!1),C=(0,r.useCallback)(e=>{let t=new URLSearchParams;Object.entries(e).forEach(e=>{let[s,a]=e;a&&"any"!==a&&""!==a&&t.set(s,a)});let s="/opx?".concat(t.toString());o.push(s,{scroll:!1})},[o]),S=(0,r.useCallback)(()=>{t({status:u,type:x,q:p,order:g,dir:b,limit:N,page:1}),C({status:u,type:x,q:p,order:g,dir:b,limit:N.toString()})},[u,x,p,g,b,N,t,C]);(0,r.useEffect)(()=>{S()},[S]);let A=async()=>{k(!0);try{let e=await fetch("/api/control/opx/score",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({actor:"ui"})}),t=await e.json();e.ok?(s("Updated ".concat(t.updated," opportunities in ").concat(t.ms,"ms")),S()):s("Recalc failed: ".concat(t.error||"Unknown error"),!0)}catch(e){s("Recalc error: ".concat(e instanceof Error?e.message:"Network error"),!0)}finally{k(!1)}};return(0,a.jsxs)("div",{className:"space-y-4 p-4 border rounded-lg bg-card",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-6 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium mb-1 block",children:"Status"}),(0,a.jsxs)(d.l6,{value:u,onValueChange:m,children:[(0,a.jsx)(d.bq,{children:(0,a.jsx)(d.yv,{})}),(0,a.jsxs)(d.gC,{children:[(0,a.jsx)(d.eb,{value:"proposed",children:"Proposed"}),(0,a.jsx)(d.eb,{value:"approved",children:"Approved"}),(0,a.jsx)(d.eb,{value:"rejected",children:"Rejected"}),(0,a.jsx)(d.eb,{value:"any",children:"Any"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium mb-1 block",children:"Type"}),(0,a.jsxs)(d.l6,{value:x,onValueChange:h,children:[(0,a.jsx)(d.bq,{children:(0,a.jsx)(d.yv,{})}),(0,a.jsxs)(d.gC,{children:[(0,a.jsx)(d.eb,{value:"beta",children:"Beta"}),(0,a.jsx)(d.eb,{value:"basis",children:"Basis"}),(0,a.jsx)(d.eb,{value:"realYield",children:"Real Yield"}),(0,a.jsx)(d.eb,{value:"arb",children:"Arbitrage"}),(0,a.jsx)(d.eb,{value:"any",children:"Any"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium mb-1 block",children:"Order"}),(0,a.jsxs)(d.l6,{value:g,onValueChange:j,children:[(0,a.jsx)(d.bq,{children:(0,a.jsx)(d.yv,{})}),(0,a.jsxs)(d.gC,{children:[(0,a.jsx)(d.eb,{value:"score",children:"Score"}),(0,a.jsx)(d.eb,{value:"var",children:"VaR"}),(0,a.jsx)(d.eb,{value:"createdAt",children:"Created"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium mb-1 block",children:"Direction"}),(0,a.jsxs)(d.l6,{value:b,onValueChange:v,children:[(0,a.jsx)(d.bq,{children:(0,a.jsx)(d.yv,{})}),(0,a.jsxs)(d.gC,{children:[(0,a.jsx)(d.eb,{value:"desc",children:"Desc ↓"}),(0,a.jsx)(d.eb,{value:"asc",children:"Asc ↑"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium mb-1 block",children:"Limit"}),(0,a.jsxs)(d.l6,{value:N.toString(),onValueChange:e=>y(Number(e)),children:[(0,a.jsx)(d.bq,{children:(0,a.jsx)(d.yv,{})}),(0,a.jsxs)(d.gC,{children:[(0,a.jsx)(d.eb,{value:"25",children:"25"}),(0,a.jsx)(d.eb,{value:"50",children:"50"}),(0,a.jsx)(d.eb,{value:"100",children:"100"}),(0,a.jsx)(d.eb,{value:"200",children:"200"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium mb-1 block",children:"Search"}),(0,a.jsx)(i.p,{placeholder:"Search idea/thesis...",value:p,onChange:e=>f(e.target.value),onKeyDown:e=>{"Enter"===e.key&&S()}})]})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(l.$,{onClick:S,variant:"outline",size:"sm",children:"Apply Filters"}),(0,a.jsx)(l.$,{onClick:A,variant:"outline",size:"sm",disabled:w,children:w?"Recalculating...":"Recalc Scores"})]})]})}function c(){return(0,a.jsxs)("div",{className:"p-4 border rounded-lg bg-muted/50 animate-pulse",children:[(0,a.jsx)("div",{className:"h-8 bg-muted-foreground/20 rounded mb-4 max-w-[200px]"}),(0,a.jsxs)("div",{className:"flex gap-4 flex-wrap",children:[(0,a.jsx)("div",{className:"h-10 bg-muted-foreground/20 rounded w-32"}),(0,a.jsx)("div",{className:"h-10 bg-muted-foreground/20 rounded w-32"}),(0,a.jsx)("div",{className:"h-10 bg-muted-foreground/20 rounded w-48"}),(0,a.jsx)("div",{className:"h-10 bg-muted-foreground/20 rounded w-32"})]})]})}function u(e){return(0,a.jsx)(r.Suspense,{fallback:(0,a.jsx)(c,{}),children:(0,a.jsx)(o,{...e})})}var m=s(33399),x=s(70994),h=s(6910),p=s(66846);function f(e){let{score:t}=e,s=t>=70?"bg-green-500":t>=40?"bg-amber-500":"bg-red-500";return(0,a.jsx)(m.E,{className:"".concat(s," text-white"),children:t})}function g(e){let{blocking:t}=e;return 0===t.length?(0,a.jsx)("span",{className:"text-muted-foreground text-sm",children:"None"}):(0,a.jsx)("div",{className:"flex flex-wrap gap-1",children:t.map(e=>(0,a.jsx)(m.E,{variant:"destructive",className:"text-xs",children:e},e))})}function j(e){let{action:t,id:s,onConfirm:n,children:i}=e,[d,o]=(0,r.useState)(""),[c,u]=(0,r.useState)(!1);return(0,a.jsxs)(x.lG,{open:c,onOpenChange:u,children:[(0,a.jsx)(x.zM,{asChild:!0,children:i}),(0,a.jsxs)(x.Cf,{className:"sm:max-w-md",children:[(0,a.jsx)(x.c7,{children:(0,a.jsxs)(x.L3,{children:["approve"===t?"Approve":"Reject"," Opportunity"]})}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:["ID: ",s]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium",children:"Note (optional, max 500 chars)"}),(0,a.jsx)("textarea",{value:d,onChange:e=>o(e.target.value),placeholder:"Reason for ".concat(t,"..."),maxLength:500,rows:3,className:"mt-1 w-full rounded border border-input bg-background px-3 py-2 text-sm resize-none focus:outline-none focus:ring-2 focus:ring-ring"})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,a.jsx)(l.$,{variant:"outline",onClick:()=>u(!1),children:"Cancel"}),(0,a.jsx)(l.$,{onClick:()=>{n(d.slice(0,500)),o(""),u(!1)},variant:"approve"===t?"default":"destructive",children:"approve"===t?"Approve":"Reject"})]})]})]})]})}function b(e){let{data:t,loading:s,onAction:n,onToast:i}=e,[d,o]=(0,r.useState)(new Set),c=async(e,t,s)=>{if(!d.has(e)){o(t=>new Set(t).add(e));try{await n(e,t,s)&&i("Successfully ".concat(t,"ed opportunity ").concat(e))}catch(e){i("Failed to ".concat(t,": ").concat(e instanceof Error?e.message:"Unknown error"),!0)}finally{o(t=>{let s=new Set(t);return s.delete(e),s})}}};return s?(0,a.jsx)("div",{className:"p-8 text-center text-muted-foreground",children:"Loading..."}):0===t.length?(0,a.jsx)("div",{className:"p-8 text-center text-muted-foreground",children:"No opportunities found"}):(0,a.jsx)("div",{className:"border rounded-lg overflow-hidden",children:(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full",children:[(0,a.jsx)("thead",{className:"bg-muted",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"text-left p-3 font-medium",children:"Date"}),(0,a.jsx)("th",{className:"text-left p-3 font-medium",children:"Type"}),(0,a.jsx)("th",{className:"text-left p-3 font-medium",children:"Score"}),(0,a.jsx)("th",{className:"text-left p-3 font-medium",children:"Consensus"}),(0,a.jsx)("th",{className:"text-left p-3 font-medium",children:"Blocking"}),(0,a.jsx)("th",{className:"text-left p-3 font-medium",children:"VaR"}),(0,a.jsx)("th",{className:"text-left p-3 font-medium",children:"Notional%"}),(0,a.jsx)("th",{className:"text-left p-3 font-medium",children:"Idea"}),(0,a.jsx)("th",{className:"text-left p-3 font-medium",children:"Actions"})]})}),(0,a.jsx)("tbody",{children:t.map(e=>(0,a.jsxs)("tr",{className:"border-t hover:bg-muted/50",children:[(0,a.jsxs)("td",{className:"p-3",children:[(0,a.jsx)("div",{className:"text-sm",children:new Date(e.createdAt).toLocaleDateString()}),(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:e.agentCode})]}),(0,a.jsx)("td",{className:"p-3",children:(0,a.jsx)(m.E,{variant:"outline",children:e.type})}),(0,a.jsx)("td",{className:"p-3",children:(0,a.jsx)(f,{score:e.score})}),(0,a.jsxs)("td",{className:"p-3",children:[Math.round(100*e.consensus),"%"]}),(0,a.jsx)("td",{className:"p-3",children:(0,a.jsx)(g,{blocking:e.blocking})}),(0,a.jsxs)("td",{className:"p-3",children:["$",e.var.toLocaleString()]}),(0,a.jsxs)("td",{className:"p-3",children:[e.sizing.notionalPctNAV.toFixed(1),"%"]}),(0,a.jsxs)("td",{className:"p-3 max-w-xs",children:[(0,a.jsx)("div",{className:"truncate font-medium",title:e.idea,children:e.idea}),(0,a.jsx)("div",{className:"text-xs text-muted-foreground truncate",title:e.thesis,children:e.thesis}),e.risks.length>0&&(0,a.jsxs)("div",{className:"text-xs text-orange-600 truncate",children:["Risks: ",e.risks.join(", ")]})]}),(0,a.jsx)("td",{className:"p-3",children:"proposed"===e.status?(0,a.jsxs)("div",{className:"flex gap-1",children:[(0,a.jsx)(j,{action:"approve",id:e.id,onConfirm:t=>c(e.id,"approve",t),children:(0,a.jsx)(l.$,{size:"sm",variant:"outline",disabled:d.has(e.id),className:"text-green-600 hover:bg-green-50",children:(0,a.jsx)(h.A,{className:"h-3 w-3"})})}),(0,a.jsx)(j,{action:"reject",id:e.id,onConfirm:t=>c(e.id,"reject",t),children:(0,a.jsx)(l.$,{size:"sm",variant:"outline",disabled:d.has(e.id),className:"text-red-600 hover:bg-red-50",children:(0,a.jsx)(p.A,{className:"h-3 w-3"})})})]}):(0,a.jsx)(m.E,{variant:"approved"===e.status?"default":"destructive",children:e.status})})]},e.id))})]})})})}var v=s(51725),N=s(9262);function y(e){let{page:t,pages:s,limit:r,total:n,onPageChange:i,onLimitChange:o}=e,c=(t-1)*r+1,u=Math.min(t*r,n);return(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 border rounded-lg bg-card",children:[(0,a.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Showing ",c,"-",u," of ",n," opportunities"]}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-sm",children:"Per page:"}),(0,a.jsxs)(d.l6,{value:r.toString(),onValueChange:e=>o(Number(e)),children:[(0,a.jsx)(d.bq,{className:"w-20",children:(0,a.jsx)(d.yv,{})}),(0,a.jsxs)(d.gC,{children:[(0,a.jsx)(d.eb,{value:"25",children:"25"}),(0,a.jsx)(d.eb,{value:"50",children:"50"}),(0,a.jsx)(d.eb,{value:"100",children:"100"}),(0,a.jsx)(d.eb,{value:"200",children:"200"})]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)(l.$,{variant:"outline",size:"sm",disabled:t<=1,onClick:()=>i(t-1),children:[(0,a.jsx)(v.A,{className:"h-4 w-4"}),"Previous"]}),(0,a.jsxs)("span",{className:"text-sm",children:["Page ",t," of ",s]}),(0,a.jsxs)(l.$,{variant:"outline",size:"sm",disabled:t>=s,onClick:()=>i(t+1),children:["Next",(0,a.jsx)(N.A,{className:"h-4 w-4"})]})]})]})]})}function w(){return(0,a.jsxs)("div",{className:"p-4 border rounded-lg bg-card",children:[(0,a.jsx)("h3",{className:"font-medium mb-3",children:"Score Legend"}),(0,a.jsxs)("div",{className:"flex items-center gap-6 text-sm",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(m.E,{className:"bg-green-500 text-white",children:"70-100"}),(0,a.jsx)("span",{className:"text-muted-foreground",children:"High confidence"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(m.E,{className:"bg-amber-500 text-white",children:"40-69"}),(0,a.jsx)("span",{className:"text-muted-foreground",children:"Medium confidence"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(m.E,{className:"bg-red-500 text-white",children:"0-39"}),(0,a.jsx)("span",{className:"text-muted-foreground",children:"Low confidence"})]})]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground mt-2",children:"Score = Base (severity) + Consensus bonus - Guardrail penalties - VaR penalties"})]})}var k=s(98574),C=s(89366);function S(){let[e,t]=(0,r.useState)([]),[s,n]=(0,r.useState)(1),[l,i]=(0,r.useState)(1),[d,o]=(0,r.useState)(50),[c,m]=(0,r.useState)(0),[x,h]=(0,r.useState)(!1),[p,f]=(0,r.useState)(null),[g,j]=(0,r.useState)(""),[v,N]=(0,r.useState)({status:"proposed",type:"any",q:"",order:"score",dir:"desc",limit:50,page:1}),S=(0,r.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];j(t?"❌ ".concat(e):"✅ ".concat(e)),setTimeout(()=>j(""),3e3)},[]),A=(0,r.useCallback)(async e=>{h(!0),f(null);try{let s=new URLSearchParams;Object.entries(e).forEach(e=>{let[t,a]=e;a&&"any"!==a&&""!==a&&s.set(t,a.toString())});let a=await fetch("/api/read/opx/list?".concat(s.toString()),{cache:"no-store"});if(!a.ok)throw Error("HTTP ".concat(a.status));let r=await a.json();t(r.data),n(r.page),i(r.pages),o(r.limit),m(r.total)}catch(t){let e=t instanceof Error?t.message:"Failed to load opportunities";f(e),S(e,!0)}finally{h(!1)}},[S]),E=(0,r.useCallback)(e=>{N(e),A(e)},[A]),P=(0,r.useCallback)(e=>{let t={...v,page:e};N(t),A(t)},[v,A]),R=(0,r.useCallback)(e=>{let t={...v,limit:e,page:1};N(t),A(t)},[v,A]),z=(0,r.useCallback)(async(e,s,a)=>{let r=await fetch("/api/actions/opx/".concat(s),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e,actor:"ui",note:a})}),n=await r.json();if(!r.ok)throw Error(n.error||"HTTP ".concat(r.status));return("proposed"===v.status||"any"===v.status)&&(t(t=>t.map(t=>t.id===e?{...t,status:"approve"===s?"approved":"rejected"}:t)),"proposed"===v.status&&(t(t=>t.filter(t=>t.id!==e)),m(e=>e-1))),!0},[v.status]);return((0,r.useEffect)(()=>{A(v)},[]),p&&0===e.length)?(0,a.jsxs)("div",{className:"container mx-auto p-6",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"OP-X Triage"}),(0,a.jsxs)("div",{className:"p-8 text-center border rounded-lg bg-destructive/10 text-destructive",children:[(0,a.jsx)("p",{className:"mb-2",children:"Failed to load opportunities"}),(0,a.jsx)("p",{className:"text-sm",children:p}),(0,a.jsx)("button",{onClick:()=>A(v),className:"mt-4 px-4 py-2 bg-destructive text-destructive-foreground rounded hover:bg-destructive/90",children:"Retry"})]})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(k.NavigationGuard,{showBackButton:!0,backUrl:"/",storageKey:"opx-triage",data:v,children:(0,a.jsxs)("div",{className:"container mx-auto p-6 space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold",children:"OP-X Triage"}),g&&(0,a.jsx)("div",{className:"px-4 py-2 rounded bg-muted text-sm",children:g})]}),(0,a.jsx)(w,{}),(0,a.jsx)(u,{onFiltersChange:E,onToast:S}),(0,a.jsx)(b,{data:e,loading:x,onAction:z,onToast:S}),c>0&&(0,a.jsx)(y,{page:s,pages:l,limit:d,total:c,onPageChange:P,onLimitChange:R})]})}),(0,a.jsx)(C.Toaster,{})]})}},33399:(e,t,s)=>{"use strict";s.d(t,{E:()=>i});var a=s(51833);s(59693);var r=s(49639),n=s(81429);let l=(0,r.F)("inline-flex items-center rounded-full border border-amber-300/30 bg-amber-500/10 px-3 py-1 text-xs font-semibold uppercase tracking-[0.2em] text-amber-100 shadow-[0_12px_30px_-18px_rgba(250,204,21,0.65)] transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-amber-300/50 focus:ring-offset-2",{variants:{variant:{default:"border-amber-300/40 bg-amber-500/20 text-zinc-900 hover:bg-amber-400/30",secondary:"border-zinc-700/40 bg-zinc-900/60 text-amber-100/80 hover:bg-zinc-800/60",destructive:"border-rose-500/50 bg-rose-500/20 text-rose-100 hover:bg-rose-500/30",outline:"border-amber-200/40 bg-transparent text-amber-100/80 hover:border-amber-200/60"}},defaultVariants:{variant:"default"}});function i(e){let{className:t,variant:s,...r}=e;return(0,a.jsx)("div",{className:(0,n.cn)(l({variant:s}),t),...r})}},51725:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(11097).A)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},62174:(e,t,s)=>{Promise.resolve().then(s.bind(s,20405))},70994:(e,t,s)=>{"use strict";s.d(t,{Cf:()=>u,Es:()=>x,L3:()=>h,c7:()=>m,lG:()=>i,rr:()=>p,zM:()=>d});var a=s(51833);s(59693);var r=s(87676),n=s(66846),l=s(81429);function i(e){let{...t}=e;return(0,a.jsx)(r.bL,{"data-slot":"dialog",...t})}function d(e){let{...t}=e;return(0,a.jsx)(r.l9,{"data-slot":"dialog-trigger",...t})}function o(e){let{...t}=e;return(0,a.jsx)(r.ZL,{"data-slot":"dialog-portal",...t})}function c(e){let{className:t,...s}=e;return(0,a.jsx)(r.hJ,{"data-slot":"dialog-overlay",className:(0,l.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),...s})}function u(e){let{className:t,children:s,showCloseButton:i=!0,...d}=e;return(0,a.jsxs)(o,{"data-slot":"dialog-portal",children:[(0,a.jsx)(c,{}),(0,a.jsxs)(r.UC,{"data-slot":"dialog-content",className:(0,l.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",t),...d,children:[s,i&&(0,a.jsxs)(r.bm,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[(0,a.jsx)(n.A,{}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function m(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"dialog-header",className:(0,l.cn)("flex flex-col gap-2 text-center sm:text-left",t),...s})}function x(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"dialog-footer",className:(0,l.cn)("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",t),...s})}function h(e){let{className:t,...s}=e;return(0,a.jsx)(r.hE,{"data-slot":"dialog-title",className:(0,l.cn)("text-lg leading-none font-semibold",t),...s})}function p(e){let{className:t,...s}=e;return(0,a.jsx)(r.VY,{"data-slot":"dialog-description",className:(0,l.cn)("text-muted-foreground text-sm",t),...s})}},83738:(e,t,s)=>{"use strict";var a=s(81678);s.o(a,"useParams")&&s.d(t,{useParams:function(){return a.useParams}}),s.o(a,"usePathname")&&s.d(t,{usePathname:function(){return a.usePathname}}),s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}}),s.o(a,"useSearchParams")&&s.d(t,{useSearchParams:function(){return a.useSearchParams}})},85127:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(11097).A)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]])},85994:(e,t,s)=>{"use strict";s.d(t,{bq:()=>m,eb:()=>f,gC:()=>p,l6:()=>c,yv:()=>u});var a=s(51833),r=s(59693),n=s(79378),l=s(1372),i=s(20605),d=s(6910),o=s(81429);let c=n.bL;n.YJ;let u=n.WT,m=r.forwardRef((e,t)=>{let{className:s,children:r,...i}=e;return(0,a.jsxs)(n.l9,{ref:t,className:(0,o.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",s),...i,children:[r,(0,a.jsx)(n.In,{asChild:!0,children:(0,a.jsx)(l.A,{className:"h-4 w-4 opacity-50"})})]})});m.displayName=n.l9.displayName;let x=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(n.PP,{ref:t,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",s),...r,children:(0,a.jsx)(i.A,{className:"h-4 w-4"})})});x.displayName=n.PP.displayName;let h=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(n.wn,{ref:t,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",s),...r,children:(0,a.jsx)(l.A,{className:"h-4 w-4"})})});h.displayName=n.wn.displayName;let p=r.forwardRef((e,t)=>{let{className:s,children:r,position:l="popper",...i}=e;return(0,a.jsx)(n.ZL,{children:(0,a.jsxs)(n.UC,{ref:t,className:(0,o.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===l&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:l,...i,children:[(0,a.jsx)(x,{}),(0,a.jsx)(n.LM,{className:(0,o.cn)("p-1","popper"===l&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),(0,a.jsx)(h,{})]})})});p.displayName=n.UC.displayName,r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(n.JU,{ref:t,className:(0,o.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",s),...r})}).displayName=n.JU.displayName;let f=r.forwardRef((e,t)=>{let{className:s,children:r,...l}=e;return(0,a.jsxs)(n.q7,{ref:t,className:(0,o.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...l,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(n.VF,{children:(0,a.jsx)(d.A,{className:"h-4 w-4"})})}),(0,a.jsx)(n.p4,{children:r})]})});f.displayName=n.q7.displayName,r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(n.wv,{ref:t,className:(0,o.cn)("-mx-1 my-1 h-px bg-muted",s),...r})}).displayName=n.wv.displayName},89366:(e,t,s)=>{"use strict";s.d(t,{Toaster:()=>i});var a=s(51833);s(59693);var r=s(67070),n=s(66846),l=s(81429);function i(){let{toasts:e}=(0,r.dj)();return(0,a.jsx)("div",{className:"fixed top-0 right-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",children:e.map(e=>{let{id:t,title:s,description:r,variant:i,...d}=e;return(0,a.jsxs)("div",{className:(0,l.cn)("group pointer-events-auto relative flex w-full items-center justify-between space-x-2 overflow-hidden rounded-md border p-4 pr-6 shadow-lg transition-all","destructive"===i?"border-destructive bg-destructive text-destructive-foreground":"border bg-background text-foreground"),...d,children:[(0,a.jsxs)("div",{className:"grid gap-1",children:[s&&(0,a.jsx)("div",{className:"text-sm font-semibold",children:s}),r&&(0,a.jsx)("div",{className:"text-sm opacity-90",children:r})]}),(0,a.jsxs)("button",{className:"absolute right-1 top-1 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-1 group-hover:opacity-100",onClick:()=>{let e=d.onOpenChange;"function"==typeof e&&e(!1)},children:[(0,a.jsx)(n.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]},t)})})}},98574:(e,t,s)=>{"use strict";s.d(t,{NavigationGuard:()=>h});var a=s(51833),r=s(59693),n=s(30249),l=s.n(n),i=s(83738),d=s(11622),o=s(70994),c=s(8327),u=s(66846),m=s(85127),x=s(4991);function h(e){var t;let{hasUnsavedChanges:s=!1,onSave:n,data:h,storageKey:p,children:f,showBackButton:g=!0,backUrl:j,fallbackUrl:b="/"}=e,v=(0,i.useRouter)(),N=(0,i.usePathname)(),{toast:y}=(0,x.dj)(),[w,k]=(0,r.useState)(!1),[C,S]=(0,r.useState)(null),[A,E]=(0,r.useState)(!1),P=(0,r.useCallback)(async()=>{if(h&&p)try{let e={data:h,timestamp:Date.now(),pathname:N,expiresAt:Date.now()+2592e6};localStorage.setItem("adaf_autosave_".concat(p),JSON.stringify(e))}catch(e){console.warn("Failed to auto-save data:",e)}},[h,p,N]);(0,r.useEffect)(()=>{if(s&&h){let e=setInterval(P,3e4);return()=>clearInterval(e)}},[s,h,P]),(0,r.useEffect)(()=>{Object.keys(localStorage).filter(e=>e.startsWith("adaf_autosave_")).forEach(e=>{try{let t=JSON.parse(localStorage.getItem(e)||"{}");t.expiresAt&&t.expiresAt<Date.now()&&localStorage.removeItem(e)}catch(t){localStorage.removeItem(e)}})},[]);let R=(0,r.useCallback)(()=>j||(window.history.length>1?"back":b),[j,b]),z=(0,r.useMemo)(()=>R(),[R]),L="back"===z?null!=(t=null!=j?j:b)?t:"/":z;(0,r.useEffect)(()=>{let e=e=>{s&&(e.preventDefault(),e.returnValue="\xbfDesea salir sin guardar? Los datos se guardar\xe1n autom\xe1ticamente.",P())},t=e=>{s&&(e.preventDefault(),k(!0),S("back"),window.history.pushState(null,"",window.location.href))};return window.addEventListener("beforeunload",e),window.addEventListener("popstate",t),()=>{window.removeEventListener("beforeunload",e),window.removeEventListener("popstate",t)}},[s,P]);let T=async()=>{if(n){E(!0);try{await n(),y({title:"Datos guardados",description:"Los datos se han guardado correctamente."})}catch(e){y({title:"Error al guardar",description:"No se pudieron guardar los datos. Se guardar\xe1n autom\xe1ticamente.",variant:"destructive"})}finally{E(!1)}}await P(),k(!1);let e=null!=C?C:z;"back"===e?v.back():v.push(e)},D=async()=>{await P(),k(!1);let e=null!=C?C:z;"back"===e?v.back():v.push(e)};return(0,a.jsxs)(a.Fragment,{children:[g&&(s?(0,a.jsxs)(d.$,{variant:"ghost",size:"sm",onClick:()=>{if(s){k(!0),S(z);return}"back"===z?v.back():v.push(z)},className:"mb-4 text-muted-foreground hover:text-foreground",children:[(0,a.jsx)(c.A,{className:"w-4 h-4 mr-2"}),"Regresar"]}):(0,a.jsx)(d.$,{asChild:!0,variant:"ghost",size:"sm",className:"mb-4 text-muted-foreground hover:text-foreground",children:(0,a.jsxs)(l(),{href:L,prefetch:!1,children:[(0,a.jsx)(c.A,{className:"w-4 h-4 mr-2"}),"Regresar"]})})),f,(0,a.jsx)(o.lG,{open:w,onOpenChange:k,children:(0,a.jsxs)(o.Cf,{children:[(0,a.jsxs)(o.c7,{children:[(0,a.jsxs)(o.L3,{className:"flex items-center gap-2",children:[(0,a.jsx)(u.A,{className:"w-5 h-5 text-destructive"}),"\xbfDesea salir de esta p\xe1gina?"]}),(0,a.jsxs)(o.rr,{children:["Tienes cambios sin guardar. \xbfQu\xe9 deseas hacer?",(0,a.jsx)("br",{}),(0,a.jsx)("span",{className:"text-xs text-muted-foreground mt-2 block",children:"\uD83D\uDCA1 Los datos se guardan autom\xe1ticamente cada 30 segundos y se conservan por 30 d\xedas."})]})]}),(0,a.jsxs)(o.Es,{className:"gap-2",children:[(0,a.jsx)(d.$,{variant:"outline",onClick:()=>{k(!1),S(null)},children:"Quedarse"}),(0,a.jsx)(d.$,{variant:"secondary",onClick:D,children:"Salir sin guardar"}),(0,a.jsxs)(d.$,{onClick:T,disabled:A,className:"gap-2",children:[(0,a.jsx)(m.A,{className:"w-4 h-4"}),A?"Guardando...":"Guardar y salir"]})]})]})})]})}}},e=>{e.O(0,[3701,6333,249,3060,3389,4802,7913,8637,2542,5034,9959,1413,7358],()=>e(e.s=62174)),_N_E=e.O()}]);