exports.id=8519,exports.ids=[8519],exports.modules={13155:(a,b,c)=>{"use strict";c.d(b,{$H:()=>e,AL:()=>d,GA:()=>f,MS:()=>g});class d extends Error{constructor(a,b,c){super(a),this.name="LineageError",this.code=b,this.context=c}}function e(a){return"string"==typeof a&&["signal","metric","report"].includes(a)}function f(a){return"string"==typeof a&&["ingest","transform","aggregate","export"].includes(a)}function g(a){return"string"==typeof a&&/^[a-f0-9]{64}$/i.test(a)}},37351:(a,b,c)=>{"use strict";c.d(b,{pG:()=>h,p8:()=>f,Nv:()=>g});var d=c(13155),e=c(55511);async function f(a){try{let b=(await i(a.entity,a.refId)).sort((a,b)=>new Date(a.ts).getTime()-new Date(b.ts).getTime()),c=a.offset||0,f=a.limit?c+a.limit:b.length,g=b.slice(c,f),h=function(a){let b=a.map(a=>a.stage),c=[...new Set(b)],f=a[0]?.entity,g=[];switch(f){case"signal":g=["ingest"];break;case"metric":g=["aggregate"];break;case"report":g=["export"]}let h=g.filter(a=>!c.includes(a)),i=b.filter((a,c)=>b.indexOf(a)!==c),j=a.every(a=>(function(a){if(!(0,d.MS)(a.hash))return!1;try{let b=function(a){try{let b=JSON.stringify(a.outputs,Object.keys(a.outputs).sort()),c=`${b}|${a.stage}|${a.source}`;return e.createHash("sha256").update(c,"utf8").digest("hex")}catch(b){throw new d.AL("Failed to calculate lineage hash","HASH_MISMATCH",{context:a,error:b instanceof Error?b.message:"Unknown error"})}}({outputs:a.outputs,stage:a.stage,source:a.source});return a.hash===b}catch{return!1}})(a)),k=a.sort((a,b)=>new Date(a.ts).getTime()-new Date(b.ts).getTime()).map(a=>({stage:a.stage,timestamp:a.ts,source:a.source}));return{isComplete:0===h.length,missingStages:h,duplicateStages:i,integrityValid:j,timeline:k}}(g),j={refId:a.refId,entity:a.entity,events:g,eventCount:g.length,firstEventAt:g[0]?.ts||"",lastEventAt:g[g.length-1]?.ts||"",stagesSequence:h.timeline.map(a=>a.stage),sourcesSequence:h.timeline.map(a=>a.source),integrityValid:h.integrityValid};return console.log(`[Lineage] Retrieved trace for ${a.entity}:${a.refId}:`,{eventCount:j.eventCount,stagesSequence:j.stagesSequence,integrityValid:j.integrityValid}),j}catch(b){throw console.error("[Lineage] Failed to retrieve trace:",b),new d.AL("Failed to retrieve lineage trace","DATABASE_ERROR",{query:a,error:b instanceof Error?b.message:"Unknown error"})}}async function g(a){try{let b=await j();if(a.entity&&(b=b.filter(b=>b.entity===a.entity)),a.stage&&(b=b.filter(b=>b.stage===a.stage)),a.source&&(b=b.filter(b=>b.source.toLowerCase().includes(a.source.toLowerCase()))),a.q){let c=a.q.toLowerCase();b=b.filter(a=>a.source.toLowerCase().includes(c)||a.hash.toLowerCase().includes(c)||JSON.stringify(a.inputs).toLowerCase().includes(c)||JSON.stringify(a.outputs).toLowerCase().includes(c)||a.notes&&a.notes.toLowerCase().includes(c))}if(a.dateFrom||a.dateTo){let c=a.dateFrom?new Date(a.dateFrom).getTime():0,d=a.dateTo?new Date(a.dateTo).getTime():Date.now();b=b.filter(a=>{let b=new Date(a.ts).getTime();return b>=c&&b<=d})}b.sort((a,b)=>new Date(b.ts).getTime()-new Date(a.ts).getTime());let c=a.limit||100,d=a.offset||0,e=b.slice(d,d+c);return console.log(`[Lineage] Search query "${a.q}" found ${b.length} results`),{items:e,total:b.length,hasMore:d+c<b.length}}catch(b){throw console.error("[Lineage] Search failed:",b),new d.AL("Failed to search lineage events","DATABASE_ERROR",{query:a,error:b instanceof Error?b.message:"Unknown error"})}}async function h(a,b=!1){let c=await f({entity:"signal",refId:a});return b&&console.log(`[Lineage] Downstream analysis for signal ${a} not implemented`),c}async function i(a,b){let c=new Date("2025-09-29T10:00:00Z").getTime();return"signal"===a&&"defi_llama_tvl_ethereum"===b?[{id:1,entity:"signal",refId:"defi_llama_tvl_ethereum",stage:"ingest",ts:new Date(c).toISOString(),createdAt:new Date(c).toISOString(),source:"defillama",inputs:{url:"https://api.llama.fi/protocol/ethereum",method:"GET",headers:{"user-agent":"adaf-ingester"}},outputs:{type:"tvl",chain:"ethereum",value:0xa8830bad2,timestamp:"2025-09-29T10:00:00Z",currency:"USD"},hash:"a1b2c3d4e5f6789012345678901234567890abcdef1234567890abcdef123456",notes:"DeFiLlama TVL ingestion for Ethereum mainnet"},{id:2,entity:"signal",refId:"defi_llama_tvl_ethereum",stage:"transform",ts:new Date(c+3e4).toISOString(),createdAt:new Date(c+3e4).toISOString(),source:"ingest.normalizer",inputs:{rawValue:0xa8830bad2,rawTimestamp:"2025-09-29T10:00:00Z"},outputs:{normalizedValue:0xa8830bad2,confidenceScore:.95,validationRules:["positive_value","recent_timestamp"],canonicalSchema:"tvl_v2"},hash:"b2c3d4e5f6789012345678901234567890abcdef1234567890abcdef1234567a",notes:"Applied normalization and validation rules"}]:"report"===a&&"onepager_2025q3_demo.pdf"===b?[{id:5,entity:"report",refId:"onepager_2025q3_demo.pdf",stage:"export",ts:new Date(c+3e5).toISOString(),createdAt:new Date(c+3e5).toISOString(),source:"pdf:generator",inputs:{kpisHash:"c3d4e5f6789012345678901234567890abcdef1234567890abcdef1234567ab2",porHash:"d4e5f6789012345678901234567890abcdef1234567890abcdef1234567abc3",template:"onepager_v2",actor:"system@adaf.com"},outputs:{file:{path:"/reports/2025-09-29/onepager_2025q3_demo.pdf",sizeBytes:87543,pages:2},generationTimeMs:2156},hash:"e5f6789012345678901234567890abcdef1234567890abcdef1234567abcd4",notes:"OnePager PDF generated with Q3 2025 KPIs and PoR data"}]:[]}async function j(){let a=await i("signal","defi_llama_tvl_ethereum");return[...a,{id:3,entity:"metric",refId:"kpis.quarterly.2025q3",stage:"aggregate",ts:"2025-09-29T10:05:00Z",createdAt:"2025-09-29T10:05:00Z",source:"read-aggregator",inputs:{metricKeys:["tvl.ethereum","tvl.bitcoin","flows.in","flows.out"],window:"quarterly",period:"2025Q3"},outputs:{irr:.145,tvpi:1.87,moic:1.23,dpi:.45,rvpi:1.42,navUsd:1255e5,flows:{in:5e7,out:15e6}},hash:"c3d4e5f6789012345678901234567890abcdef1234567890abcdef1234567ab2",notes:"Quarterly KPIs aggregated from TVL and cash flow signals"},...await i("report","onepager_2025q3_demo.pdf")]}c(91473)},56161:()=>{},91473:(a,b,c)=>{"use strict";c.d(b,{Dm:()=>W,FD:()=>z,FO:()=>B,F_:()=>Y,IA:()=>u,IX:()=>K,Jc:()=>X,Kk:()=>y,On:()=>F,P_:()=>A,Py:()=>E,YW:()=>i,Ys:()=>m,ZZ:()=>Z,_T:()=>x,aF:()=>ac,fi:()=>w,j:()=>f,jH:()=>R,mQ:()=>Q,qB:()=>J,u5:()=>e,uj:()=>h,vH:()=>g,wF:()=>P});var d=c(50029);let e=new d.Registry;d.collectDefaultMetrics({register:e});let f=new d.Counter({name:"adaf_signals_processed_total",help:"Signals processed total"}),g=new d.Counter({name:"adaf_alerts_created_total",help:"Alerts created total"}),h=new d.Counter({name:"adaf_opportunities_created_total",help:"Opportunities created total"}),i=new d.Gauge({name:"adaf_worker_last_tick_ts",help:"Unix timestamp of last worker tick"}),j=new d.Counter({name:"adaf_api_requests_total",help:"API requests total",labelNames:["route","method","status"]}),k=new d.Counter({name:"adaf_api_errors_total",help:"API requests resulting in error status (>=400)",labelNames:["route","method","status"]}),l=new d.Histogram({name:"adaf_api_request_duration_seconds",help:"API request duration in seconds",labelNames:["route","method"],buckets:[.025,.05,.1,.25,.5,1,2]});function m(a,b,c,d){try{let e=b.toUpperCase(),f=String(c);j.labels({route:a,method:e,status:f}).inc(),c>=400&&k.labels({route:a,method:e,status:f}).inc(),"number"==typeof d&&Number.isFinite(d)&&d>=0&&l.labels({route:a,method:e}).observe(d)}catch{}}let n=new d.Counter({name:"adaf_opx_actions_total",help:"OP-X actions total",labelNames:["action","status"]}),o=new d.Counter({name:"adaf_blockspace_request_total",help:"Blockspace simulations executed",labelNames:["decision","mev_protection"]}),p=new d.Histogram({name:"adaf_blockspace_latency_seconds",help:"Latency of blockspace simulations",labelNames:["mev_protection"],buckets:[.02,.05,.1,.25,.5,1]}),q=new d.Histogram({name:"adaf_vaults_sim_latency_seconds",help:"Latency of LAV vault simulations",labelNames:["liquidity_band"],buckets:[.05,.1,.2,.4,.8,1.5]}),r=new d.Counter({name:"adaf_alpha_factory_signal_total",help:"Signals generated by the Alpha Factory simulation",labelNames:["strategy"]}),s=new d.Counter({name:"adaf_event_alpha_alert_total",help:"Event alpha alerts classified by severity",labelNames:["severity"]}),t=new d.Gauge({name:"adaf_liquidity_backstop_reserve_ratio",help:"Reserve multiplier recommended by the liquidity backstop planner",labelNames:["desk"]});function u(a,b){try{n.labels({action:a,status:b}).inc()}catch{}}let v=new d.Gauge({name:"adaf_opx_backlog_total",help:"OP-X backlog total by status",labelNames:["status"]});function w(a,b){try{v.labels({status:a}).set(b)}catch{}}function x(a,b,c){try{let d=b?"enabled":"disabled";o.labels({decision:a,mev_protection:d}).inc(),"number"==typeof c&&Number.isFinite(c)&&c>=0&&p.labels({mev_protection:d}).observe(c/1e3)}catch{}}function y(a,b){try{"number"==typeof b&&Number.isFinite(b)&&b>=0&&q.labels({liquidity_band:a||"unknown"}).observe(b/1e3)}catch{}}function z(a){try{if(!Array.isArray(a)||0===a.length)return void r.labels({strategy:"unknown"}).inc();a.forEach(a=>{r.labels({strategy:a}).inc()})}catch{}}function A(a){try{if(!Array.isArray(a)||0===a.length)return void s.labels({severity:"unknown"}).inc();a.forEach(a=>{s.labels({severity:a}).inc()})}catch{}}function B(a,b){try{"number"==typeof b&&Number.isFinite(b)&&t.labels({desk:a||"unknown"}).set(Math.max(0,b))}catch{}}let C=new d.Counter({name:"adaf_derivs_funding_alerts_total",help:"Derivatives funding alerts total",labelNames:["asset","exchange"]}),D=new d.Gauge({name:"adaf_derivs_funding_neg_hours",help:"Hours of negative funding by asset and exchange",labelNames:["asset","exchange"]});function E(a,b){try{C.labels({asset:a,exchange:b}).inc()}catch{}}function F(a,b,c){try{D.labels({asset:a,exchange:b}).set(c)}catch{}}let G=new d.Counter({name:"adaf_dqp_incidents_total",help:"DQP incidents total by kind, source, and agent",labelNames:["kind","source","agentCode"]}),H=new d.Gauge({name:"adaf_dqp_sources_status",help:"Number of sources by status (ok/warn/fail)",labelNames:["status"]}),I=new d.Gauge({name:"adaf_dqp_last_freshness_minutes",help:"Last calculated freshness in minutes by source and agent",labelNames:["source","agentCode","type"]});function J(a,b,c){try{G.labels({kind:a,source:b,agentCode:c}).inc()}catch{}}function K(a,b){try{H.labels({status:a}).set(b)}catch{}}let L=new d.Counter({name:"adaf_lineage_events_total",help:"Lineage events recorded total",labelNames:["stage","entity","source"]}),M=new d.Counter({name:"adaf_lineage_search_total",help:"Lineage search operations total",labelNames:["entity","stage","source","status"]}),N=new d.Histogram({name:"adaf_lineage_search_duration_seconds",help:"Lineage search operation duration in seconds",buckets:[.05,.1,.25,.5,1,2,5]}),O=new d.Counter({name:"adaf_lineage_views_total",help:"Lineage UI views total",labelNames:["entity"]});function P(a,b,c,d="ok"){try{M.labels({entity:a||"unknown",stage:b||"unknown",source:c||"unknown",status:d}).inc()}catch{}}function Q(a){try{N.observe(a)}catch{}}function R(a){try{O.labels({entity:a}).inc()}catch{}}let S=new d.Counter({name:"adaf_academy_exercises_run_total",help:"Academy exercises run total"}),T=new d.Counter({name:"adaf_academy_lessons_started_total",help:"Academy lessons started total"}),U=new d.Counter({name:"adaf_academy_lessons_completed_total",help:"Academy lessons completed total"}),V=new d.Counter({name:"adaf_academy_quiz_submissions_total",help:"Academy quiz submissions total"});function W(){try{S.inc()}catch{}}function X(){try{T.inc()}catch{}}function Y(){try{U.inc()}catch{}}function Z(){try{V.inc()}catch{}}let $=new d.Counter({name:"adaf_news_oracle_runs_total",help:"Total runs of the news oracle pipeline"}),_=new d.Counter({name:"adaf_news_oracle_escalations_total",help:"News oracle escalations total"}),aa=new d.Counter({name:"adaf_news_oracle_dismissed_total",help:"News oracle dismissed items total"}),ab=new d.Gauge({name:"adaf_news_oracle_standby_total",help:"Current number of news analyses in standby"});function ac(a,b,c,d){try{$.inc(a),ab.set(Math.max(0,b)),c>0&&_.inc(c),d>0&&aa.inc(d)}catch{}}e.registerMetric(f),e.registerMetric(g),e.registerMetric(h),e.registerMetric(i),e.registerMetric(j),e.registerMetric(k),e.registerMetric(l),e.registerMetric(n),e.registerMetric(o),e.registerMetric(p),e.registerMetric(q),e.registerMetric(r),e.registerMetric(s),e.registerMetric(t),e.registerMetric(v),e.registerMetric(C),e.registerMetric(D),e.registerMetric(G),e.registerMetric(H),e.registerMetric(I),e.registerMetric(L),e.registerMetric(M),e.registerMetric(N),e.registerMetric(O),e.registerMetric(S),e.registerMetric(T),e.registerMetric(U),e.registerMetric(V),e.registerMetric($),e.registerMetric(_),e.registerMetric(aa),e.registerMetric(ab)},92609:()=>{}};