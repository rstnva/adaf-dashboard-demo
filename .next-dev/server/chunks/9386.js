exports.id=9386,exports.ids=[9386],exports.modules={25410:(a,b,c)=>{"use strict";c.d(b,{bt:()=>j,g7:()=>h,hS:()=>i});var d=c(41315),e=c(76730),f=c(50463),g=c(68017);async function h(a,b){let c=(0,e.Eq)();if(!c.featureEnabled)return(0,g.V6)(b,404),d.NextResponse.json({error:"feature_disabled",message:"Equities AI sleeve is not enabled for this environment."},{status:404,headers:{"Cache-Control":"no-store"}});try{await (0,f.PS)("feature:equities-ai")}catch(a){return(0,g.V6)(b,403),d.NextResponse.json({error:"forbidden",message:"You do not have access to Equities AI sleeve."},{status:403,headers:{"Cache-Control":"no-store"}})}let h={dryRun:c.dryRun,cacheTtlMs:c.cacheTtlMs,now:()=>new Date,abortSignal:a.signal};return{runtime:c,providerContext:h}}function i(a,b,c=500){return console.error(`[Equities API] ${a} failed`,b),(0,g.V6)(a,c),d.NextResponse.json({error:"internal_error",message:"Unexpected error while processing equities request."},{status:c,headers:{"Cache-Control":"no-store"}})}function j(a,b,c,e={}){return(0,g.V6)(a,200),d.NextResponse.json(c,{status:200,headers:{"Cache-Control":`public, s-maxage=${Math.floor(b.cacheTtlMs/1e3)}, stale-while-revalidate=30`,"X-Equities-Dry-Run":String(b.dryRun),...e}})}},45679:(a,b,c)=>{"use strict";c.d(b,{$:()=>f,A:()=>e});var d=c(76730);class e{async fetch(a,b){let c=(0,d.Eq)(),e=b.now??(()=>new Date),f={dryRun:c.dryRun,cacheTtlMs:c.cacheTtlMs,abortSignal:b.abortSignal,now:e};return this.handleFetch(a,f)}async health(){return{key:this.key,status:"ok",message:"Health check not implemented yet",checkedAt:new Date().toISOString()}}}function f(a,b){return async(c,d)=>{if(d.dryRun)return Promise.resolve(b());try{return await c()}catch(c){return console.warn(`[EquitiesProvider:${a}] Execution failed, returning dry-run payload`,c),b()}}}},47866:(a,b,c)=>{"use strict";c.d(b,{w:()=>f});var d=c(45679);class e extends d.A{async handleFetch(a,b){return(0,d.$)(this.key,()=>a.tickers.map(a=>({ticker:a,currency:"USD",marketCapUsd:1e8,peRatio:15,forwardPeRatio:14.5,pegRatio:1.2,dividendYield:.012,revenueGrowthYoY:.08,epsGrowthYoY:.1,freeCashFlowMargin:.22,updatedAt:b.now().toISOString(),source:"mock"})))(async()=>a.tickers.map(a=>({ticker:a,currency:"USD",marketCapUsd:null,peRatio:null,forwardPeRatio:null,pegRatio:null,dividendYield:null,revenueGrowthYoY:null,epsGrowthYoY:null,freeCashFlowMargin:null,updatedAt:b.now().toISOString(),source:"mock"})),b)}constructor(...a){super(...a),this.key="equities:fundamentals",this.description="Institutional fundamentals from FactSet/Bloomberg",this.supportedMarkets=["US","CA","MX","EU"]}}let f=new e},50463:(a,b,c)=>{"use strict";c.d(b,{PS:()=>k,_m:()=>j,cl:()=>i});let d=process.env.ADAF_RBAC_DEFAULT_ROLE,e="viewer"===d||"user"===d||"admin"===d||"system"===d?d:"admin",f=["feature:summer","feature:echarts","feature:semaforo","feature:blockspace","feature:vaults-lav","feature:alpha-factory","feature:vol-pro","feature:event-alpha","feature:mm-selective","feature:tca","feature:cosmos-executor","feature:liquidity-backstop","feature:equities-ai","feature:news_oracle","admin:control","admin:reports"],g={viewer:[],user:["feature:summer","feature:echarts","feature:blockspace","feature:vaults-lav","feature:alpha-factory","feature:equities-ai","feature:news_oracle"],admin:f,system:f},h={viewer:1,user:2,admin:3,system:4};async function i(a){if("admin"!==e){if(h[e]<h[a])throw Error(`Insufficient permissions. Required: ${a}, Current: ${e}`)}}function j(a){return"admin"===e||[...g[e]??[]].includes(a)}function k(a){if(!j(a))throw Error(`Missing required permission: ${a}`)}},56161:()=>{},63090:(a,b,c)=>{"use strict";c.d(b,{U:()=>f});var d=c(45679);class e extends d.A{async handleFetch(a,b){return(0,d.$)(this.key,()=>a.tickers.flatMap(c=>Array.from({length:Math.min(a.limit??5,5)},(a,d)=>({ticker:c,filer:`Mock Fund ${d+1}`,filerType:"13F",positionUsd:5e7-5e6*d,shares:5e5-5e4*d,weightBps:1200-150*d,conviction:0===d?"increasing":"static",reportedAt:b.now().toISOString(),source:"mock"}))))(async()=>a.tickers.map(a=>({ticker:a,filer:"Mock Fund",filerType:"13F",positionUsd:null,shares:null,weightBps:null,conviction:"static",reportedAt:b.now().toISOString(),source:"mock"})),b)}constructor(...a){super(...a),this.key="equities:institutional-ownership",this.description="Tracks 13F/13D/13G filings and conviction changes.",this.supportedMarkets=["US"]}}let f=new e},68017:(a,b,c)=>{"use strict";c.d(b,{V6:()=>h,Zl:()=>i,mG:()=>j,$i:()=>k});let d={apiHits:0,cacheHits:0,modelRuns:0,dryRunExecutions:0,recommendationPushes:0},e=!1,f={},g={};try{let a=c(50029);a.register,f.apiHits=new a.Counter({name:"equities_ai_api_hits_total",help:"Total API hits for Equities AI endpoints",labelNames:["route","status"]}),f.cacheHits=new a.Counter({name:"equities_ai_cache_hits_total",help:"Equities AI cache hits",labelNames:["resource"]}),f.modelRuns=new a.Counter({name:"equities_ai_model_runs_total",help:"Total model executions",labelNames:["model","dryRun"]}),f.dryRunExecutions=new a.Counter({name:"equities_ai_dry_run_total",help:"Dry-run model executions"}),f.recommendationPushes=new a.Counter({name:"equities_ai_recommendations_total",help:"Recommendations packages generated",labelNames:["dryRun"]}),g.modelLatency=new a.Histogram({name:"equities_ai_model_latency_seconds",help:"Model latency seconds",labelNames:["model"],buckets:[.05,.1,.2,.5,1,2,5]}),e=!0}catch{e=!1}function h(a,b){d.apiHits+=1,e&&f.apiHits&&f.apiHits.inc({route:a,status:String(b)})}function i(a){d.cacheHits+=1,e&&f.cacheHits&&f.cacheHits.inc({resource:a})}function j(a){d.modelRuns+=1,a.dryRun&&(d.dryRunExecutions+=1),e&&f.modelRuns&&f.modelRuns.inc({model:a.model,dryRun:String(a.dryRun)}),e&&f.dryRunExecutions&&a.dryRun&&f.dryRunExecutions.inc(),e&&g.modelLatency&&g.modelLatency.observe({model:a.model},a.latencyMs/1e3)}function k(a){d.recommendationPushes+=1,e&&f.recommendationPushes&&f.recommendationPushes.inc({dryRun:String(a)})}},73859:(a,b,c)=>{"use strict";c.d(b,{v:()=>f});var d=c(45679);class e extends d.A{async handleFetch(a,b){return(0,d.$)(this.key,()=>a.tickers.map((a,c)=>({ticker:a,price:100+c,currency:"USD",change1D:.01,change5D:.03,change1M:.08,changeYtd:.22,volume:1e6,volatility30D:.25,updatedAt:b.now().toISOString(),source:"mock"})))(async()=>a.tickers.map(a=>({ticker:a,price:null,currency:"USD",change1D:null,change5D:null,change1M:null,changeYtd:null,volume:null,volatility30D:null,updatedAt:b.now().toISOString(),source:"mock"})),b)}constructor(...a){super(...a),this.key="equities:prices",this.description="Real-time and delayed equity pricing.",this.supportedMarkets=["US","CA","MX","EU","APAC"]}}let f=new e},73949:(a,b,c)=>{"use strict";c.d(b,{P:()=>f});let d={momentumScore:.2,qualityScore:.2,valueScore:.2,growthScore:.15,sentimentScore:.1,liquidityScore:.1,macroScore:.05};function e(a){return null==a||Number.isNaN(a)?0:Math.max(-1,Math.min(1,a))}function f(a,b,c={}){let g={...d,...c},h=Object.values(g).reduce((a,b)=>a+b,0);return a.map((a,c)=>{let d=function(a,b){let c=b.fundamentals[a]??null,d=b.prices[a]??null,f=e(d?.change1M??null),g=e(c?.peRatio?1/(c?.peRatio??1):null),h=e(c?.freeCashFlowMargin??null),i=e(c?.revenueGrowthYoY??null),j=e(d?.change5D??null);return{momentumScore:f,qualityScore:h,valueScore:g,growthScore:i,sentimentScore:j,liquidityScore:e(d?.volume?Math.log(d.volume)/20:null),macroScore:"risk-on"===b.macroRegime?.3:"risk-off"===b.macroRegime?-.3:0}}(a,b),f=Object.entries(d).reduce((a,[b,c])=>a+c*(g[b]??0),0)/(h||1)*100;return{id:`${a}-${Date.now()}-${c}`,ticker:a,horizonDays:20,conviction:f>20?"high":f>5?"medium":"low",compositeScore:f,regime:"risk-off"===b.macroRegime?"bear":"risk-on"===b.macroRegime?"bull":"sideways",dimensions:d,rationale:"Multi-factor blend scaffold. Replace with production-grade rationale generator.",generatedAt:new Date().toISOString(),modelVersion:"scaffold-0.1.0",tags:["scaffold","multi-factor"]}})}},76730:(a,b,c)=>{"use strict";c.d(b,{Eq:()=>g});let d=process.env.NEXT_PUBLIC_FF_EQUITIES_AI_ENABLED,e=process.env.NEXT_PUBLIC_FF_EQUITIES_AI_DRY_RUN;function f(){return void 0!==d&&"true"===d}function g(){return{featureEnabled:f(),dryRun:!f()||void 0===e||"false"!==e,cacheTtlMs:Number(process.env.EQUITIES_AI_CACHE_TTL_MS??6e4)}}},84235:(a,b,c)=>{"use strict";c.d(b,{b:()=>f});var d=c(45679);class e extends d.A{async handleFetch(a,b){return(0,d.$)(this.key,()=>a.tickers.map(a=>({vehicle:`${a}-ETF`,ticker:a,netFlowUsd:5e6,flow1DUsd:15e5,flow5DUsd:75e5,flow1MUsd:22e6,aumUsd:42e8,updatedAt:b.now().toISOString(),source:"mock"})))(async()=>a.tickers.map(a=>({vehicle:`${a}-ETF`,ticker:a,netFlowUsd:null,flow1DUsd:null,flow5DUsd:null,flow1MUsd:null,aumUsd:null,updatedAt:b.now().toISOString(),source:"mock"})),b)}constructor(...a){super(...a),this.key="equities:etf-flows",this.description="Aggregates ETF primary flows and AUM shifts.",this.supportedMarkets=["US"]}}let f=new e},92609:()=>{}};